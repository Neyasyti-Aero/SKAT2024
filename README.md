# SKAT2024
Репозиторий для выполнения требований к подготовке производственного отчета команды **НЕЯСЫТИ АЭРО**, принявшей участие в СКАТ 2024

# Файлы
Схемы плат представлены в формате *SchDoc (Altium Designer)*. Для их просмотра можно использовать online-инструмент [Altium Viewer](https://www.altium.com/viewer/). Структурная схема (в составе схемы бортового оборудования) и фотографии изделия в сборе представлены в полном тексте производственного отчета команды **НЕЯСЫТИ АЭРО**.

# Полетный контроллер Стриж
Полетный контроллер «Стриж» - изделие собственной разработки, на основе микросхемы `К1921ВК01Т2` (ядро `ARM Cortex-M4`), которую можно считать достаточно близким аналогом `STM32F427ZGT6`. Максимальная тактовая частота − 200 МГц.

Компоновка изделия: 3 печатные платы в пластмассовом корпусе (плата питания нижняя, плата контроллера верхняя, плата ПР1803Н − убраны в пластмассовый корпус, изготовленный методом 3D-печати). Плата питания (нижняя плата) имеет размер 53x55 мм, средняя и верхняя − размером 53x45 мм, их коммутация осуществляется посредством межплатных разъемов, расположенных по краям (по длине) изделия. Электропитание на плату подается от литий-полимерной аккумуляторной батареи через силовой разъем XT60-M, расположенный на нижней плате. Питание подводится к выводу входного напряжения VIN DC-DC преобразователя `MP1584EN`, его выходное напряжение составляет 5В. Это напряжение подаётся на вход расположенного на верхней плате линейного регулятора напряжения `КФ1158Н`, который питает микроконтроллер `К1921ВК01Т2`, инерциальный модуль, компас и внешние подключаемые устройства (выходное напряжение стабилизатора 3,3 В). Помимо силового разъёма XT60-M, питание на микроконтроллер, датчики и внешние устройства может быть подано при подключении полетного контроллера к компьютеру посредством разъема USB TYPE-C-31-M-12, или же при подключении программатора-отладчика. Для подключения к полетному контроллеру сервоприводов на нижней плате предусмотрены 13 выходов питания и ШИМ-сигнала управления. ESC подключаются к полетному контроллеру по CAN-шине. Питание на сервоприводы может быть подано только при подключении к полетному контроллеру аккумуляторной батареи. Для питания сервоприводов на нижней плате устанавливается отдельный DC-DC преобразователь `MP1584EN`, выходное напряжение Vout = 5 В, максимальный ток – 3 А.

Три платы (верхняя, ПР1803Н, и нижняя) полетного контроллера STRIZH соеденяются между собой посредством двухрядных межплатных разъемов с шагом 1.27 мм.

## Верхняя плата
Плата, содержащая микроконтроллер и датчики с системой их термостабилизации. Для питания датчиков (3.3 В) предназначен отдельный линейный регулятор напряжения `КФ1158Н`, на вход которого подается напряжение 5 В с нижней платы.

На плате один разъем типа picoblade для подключения отладчика-программатора (SWD), и одно USB Type-C гнездо для подключения к наземной станции (ПК с конфигуратором). Гнездо Type-C также может быть использовано для программирования (для входа в DFU-режим необходимо нажать кнопку BOOT на нижней плате при подаче питания).

Среди интегральных микросхем на плате, помимо датчиков и микроконтроллера, внешняя Nor-flash память (подключение к МК - SPI), а также трансивер CAN-интерфейса.

Для световой индикации используются 3 светодиода.

Список датчиков:
- `QMC5883L` (компас)
- `BMM150` (компас)
- `BMI055` (IMU)
- `BMI270` (IMU)
- `QMI8658` (IMU)
- `BMP388` (барометр)
- `BMP280` (барометр)

Их характеристики приводятся в тексте производственного отчета.

IMU-датчики полетного контроллера STRIZH помещены в корпус малых размеров (термостат, на схеме не показан), внутри которого за счет обогрева резисторами поддерживается постоянная температура (обратная связь – резистивные делители напряжения с термисторами в нижнем плече, термисторы расположены вблизи датчиков). Таким образом, система термостатирования представляет из себя замкнутую систему автоматического регулирования, в качестве устройства управления выступает микроконтроллер: программно реализован ПИ-регулятор температуры внутри термостата. Повышение отказоустойчивости системы в целом достигается за счет двойного-тройного резервирования всех критически важных составляющих её элементов. Отказ датчика обнаруживается микроконтроллером при отсутствии от соответствующего датчика (в течение заданного тайм-аута) ответа на управляющий байт во время операции чтения.

## ПР1803Н
Плата с навигационно-связным модулем `ПР1803Н`. Питание (4.2 В) подается с нижней платы. Подключен к микроконтроллеру через межплатный разъем (UART)

`ПР1803Н` - навигационно-связной модуль, в разработанном полетном контроллере Стриж используется для передачи телеметрии через сотовую связь, а также для мультисистемного (GPS, ГЛОНАСС, BeiDou, Galileo) позиционирования. Рабочий частотный диапазон: B1 (LTE FDD). Частота передачи: от 1920 до 1980 МГц. Частота приема: от 2110 до 2170 МГц.

## Нижняя плата
Плата используется для подачи питания на верхнюю плату (5 В), плату с ПР1803Н (4.2 В), сервоприводы (5 В). Для этого используются три DC/DC преобразователя `MP1584EN`, на входы которых подается напряжение АКБ.

Имеет разъемы (типа picoblade) USART, I2C, SPI, CAN для подключения внешних устройств, гнездо USB Type-C для питания Orange Pi. Помимо того на плате два силовых разъема XT60 для подключения АКБ (от 2S до 6S) и ESC, 13 ШИМ-выходов сервоприводов/моторов.

На плате микросхема OSD-генератора `AT7456`, который подключен к микроконтроллеру через межплатный разъем (SPI). Для подключения камеры и VTX на плате 2 разъема типа picoblade. Напряжение питания камеры - 5 В, напряжение питания VTX соответствует напряжению АКБ.

На плате 2 светодиода, 1 кнопка (BOOT, для программирования в режиме DFU).
